# 事务
> 由一组SQL语句组成的逻辑处理单元，事务具有以下4个属性

属性|description
---|---
原子性<br>**Atomicity**|一个原子操作单元，其对数据的修改<br>**要么全都执行，要么全都不执行**
一致性<br>**Consistent**|**在事务开始和完成时，数据都必须保持一致状态**<br>这意味着所有相关的数据规则都必须应用于事务的修改，以保持数据的完整性；<br>事务结束时，所有的内部数据结构（如B树索引或双向链表）也都必须是正确的。
隔离性<br>**Isolation**|数据库系统提供一定的隔离机制，保证事务在不受外部并发操作影响的“独立”环境执行<br>**同一时间，只允许一个事务请求同一数据，不同的事务之间彼此没有任何干扰**<br>事务处理过程中的中间状态对外部是不可见的，反之亦然
持久性<br>**Durable**|**事务完成之后，它对于数据的修改是永久性的，不能回滚**<br>即使出现系统故障也能够保持。

# 隔离性
### MySQL四种隔离级别
级别|name|description
---|---|---
读未提交|Read Uncommitted|一个事务还没有提交时，它所做的变更能够被其他事务看到
读已提交|Read Committed|一个事务只有在提交之后，它所做的变更才能被其他事务看到
可重复读|Repeated Read|**InnoDB默认级别**<br>一个事务中看到的数据始终是一致的
串行读|Serializable|为记录加锁，出现锁冲突时，后边的事务必须等待前边的事务执行完成才能继续

# 脏读、幻读、不可重复读
类型|description
---|---promethues
脏读|读取未提交数据
幻读|前后多次读取，数据总量不一致
不可重复读|前后多次读取，数据内容不一致

## 脏读
step|事务1|事务2
---|---|---
1||开始事务
2|开始事务|
3||查询账户余额为2000元
4||取款1000元，余额被更改为1000元
5|查询账户余额为1000元(产生脏读)|
6||取款操作发生未知错误，事务回滚，余额变更为2000元
7|转入2000元，余额被更改为3000元(脏读的1000+2000)|
8|提交事务|
9|产生脏数据！！！|
